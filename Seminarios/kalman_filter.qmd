---
title: "Kalman Filter"
author: "Felipe Marques"
format: 
  revealjs:
    incremental: true
    theme: [default, custom.scss]
    chalkboard: true
editor: visual
---

## Sumário

1.  [Introdução](#sec-introducao)
2.  [*State Space Representation*](#sec-state-space)
3.  *Kalman Recursion*
    1.  *Kalman Filter*
    2.  *Kalman Prediction*
    3.  *Kalman Smoothing*
4.  Estimação dos parâmetros
5.  Inferência com *Kalman Filter*

# State Space Representation

---

## Introdução {#sec-introducao}

A representação em estado de espaço é uma forma conveniente de representar as dinâmicas de uma variável através de duas equações que a descreve. (melhorar essa parte)

Essa representação será útil quando tratarmos dos algoritmos de Kalman.

---

## State Space Representation {#sec-state-space .unnumbered}

Considere,

-   $\underset{(n \times 1)}{\mathbf{y}_t}$ um vetor de retornos observados,
-   $\underset{(r \times 1)}{\xi_t}$ um vetor possívelmente não observado,
-   $\underset{(k \times 1)}{\mathbf{x}_t}$ um vetor de variáveis exógenas,
-   $\mathbf{F}_{(r \times r)}, \mathbf{A}_{(n \times k)}', \mathbf{H}'_{(n \times r)}$ matrizes de coeficientes.

---

Então, a representação em estado de espaço de um modelo é da forma:

. . .

$$
\begin{equation}
\begin{array}{ccl}
  \mathbf{y}_t & = & \mathbf{A}'\mathbf{x}_t + \mathbf{H}'\xi_t + \mathbf{w}_t \\
  \xi_{t+1} & = & \mathbf{F}\xi_t + \mathbf{v}_t
\end{array}
\end{equation}
$$

. . .

Onde, $\mathbf{v}_t,\mathbf{w}_t \sim WN$

. . .

$\textrm{Var}(\mathbf{v}_t) = \mathbf{Q}$ e $\textrm{Var}(\mathbf{w}_t) = \mathbf{R}$. Além disso, $\textrm{Cov}(\mathbf{v}_t,\mathbf{w}_k) = 0, \forall t,k$.

. . .

A equação de cima é chamada de *observation equation*, enquanto a de baixo é chamada de *state equation*.

---

### Exemplos

Considere o processo AR(p) dado da forma:

$$
y_{t+1} - \mu = \phi_1(y_t - \mu) + \ldots + \phi_p(y_{t-p+1} - \mu) + \epsilon_{t+1}
$$

onde $\epsilon_t \sim WN(0, \sigma^2)$

blablabla

---

# Kalman Recursion

---

## Kalman Recursion

A recursão de Kalman é um método iterativo e recursivo para encontrar o melhor estimador linear de $\xi_t$, utilizando toda informação disponível até o momento.

Nesse sentido, em geral, o interesse está em um desses 3 casos:

- *filter* ($\hat\xi_{t|t}$)
- *prediction* ($\hat\xi_{t+1|t}$)
- *smoothing* ($\hat\xi_{\tau|t}, \tau < t$)
---

## Kalman Filter

---

# Estimação dos parâmetros

## Máxima verossimilhança

A estimação dos parâmetros desconhecidos é feita através do método de máxima verossimilhança.

Caso $\xi_1$ e $\{\mathbf{w}_t,\mathbf{v}_t\}$
